"use strict";(self.webpackChunkant_open_source=self.webpackChunkant_open_source||[]).push([[3177],{71380:(e,t,a)=>{a.d(t,{A:()=>g});a(96540);var n=a(1710);const s={boardContainer:"boardContainer_WfQV",boardTitle:"boardTitle_gXLz",boardTitleIcon:"boardTitleIcon_P8WV",boardTitleText:"boardTitleText_xCeI",nameContainer:"nameContainer_rLLY",ellipsis:"ellipsis_pndQ",icon:"icon_b87Q",iconRounded:"iconRounded_Sksg",openrankContainer:"openrankContainer_jQP3",tag:"tag_X9mx",table:"table_RV3K",th:"th_IipV",tr:"tr_NQZX",thr:"thr__yxs",td:"td_l5d6",divider:"divider_GlZm",flagContainer:"flagContainer_G5Uw",flag:"flag_JV8o",bg:"bg_ID0k",inputDiv:"inputDiv_RN1A",inputColHeaderContainer:"inputColHeaderContainer_KjK1",inputColHeaderItem:"inputColHeaderItem_Wv9X",inputRow:"inputRow_E156",dataInput:"dataInput_TgLS",titleInput:"titleInput_knpb",columnCountInput:"columnCountInput_T7kU",inputSelect:"inputSelect_GJ00",numberContainer:"numberContainer_JAO7"};var r=a(74848);const i=e=>{let{children:t,title:a}=e;return(0,r.jsxs)("div",{className:s.boardContainer,children:[(0,r.jsxs)("div",{className:s.boardTitle,children:[(0,r.jsx)("img",{src:(0,n.T_)("leaderboard/earth-animation.gif"),alt:"",className:s.boardTitleIcon}),(0,r.jsx)("span",{className:s.boardTitleText,children:a})]}),t]})};var l=a(1530);function o(e){let{table:t}=e;return(0,r.jsx)("div",{children:(0,r.jsxs)("table",{className:s.table,children:[(0,r.jsx)("thead",{children:t.getHeaderGroups().map((e=>(0,r.jsx)("tr",{className:s.thr,children:e.headers.map((e=>(0,r.jsx)("th",{className:s.th,style:{width:e.getSize()},children:e.isPlaceholder?null:(0,l.Kv)(e.column.columnDef.header,e.getContext())},e.id)))},e.id)))}),(0,r.jsx)("tbody",{children:t.getRowModel().rows.map((e=>(0,r.jsx)("tr",{className:e.index%2==0?s.tr_even:s.tr_odd,children:e.getVisibleCells().map((e=>(0,r.jsx)("td",{className:s.td,style:{width:e.column.getSize()},children:(0,l.Kv)(e.column.columnDef.cell,e.getContext())},e.id)))},e.id)))})]})})}var d=a(33888);a(21312);const c=e=>+e.toFixed(2),u=e=>{let{number:t,delta:a}=e;return 0===a||null==a?(0,r.jsx)("div",{className:s.numberContainer,children:(0,r.jsx)("span",{className:s.number,children:c(t)})}):"-"===a?(0,r.jsxs)("div",{className:s.numberContainer,children:[(0,r.jsx)("span",{className:s.number,children:c(t)}),(0,r.jsx)("img",{className:s.tag,src:(0,n.T_)("leaderboard/new.svg"),alt:"new"})]}):(0,r.jsxs)("div",{className:s.numberContainer,children:[(0,r.jsx)("span",{children:c(t)}),(0,r.jsx)("img",{className:s.tag,src:a>0?(0,n.T_)("leaderboard/increase.svg"):(0,n.T_)("leaderboard/decrease.svg"),alt:"increase/decrease"}),(0,r.jsx)("span",{children:c(Math.abs(a))})]})},p=e=>{let{icon:t,name:a,rounded:n}=e;return(0,r.jsxs)("div",{className:s.nameContainer,children:[(0,r.jsx)("img",{src:t,alt:"",className:`${s.icon} ${n?s.iconRounded:""}`}),(0,r.jsx)("span",{className:s.ellipsis,children:a})]})},m=[{name:"String",fieldsNeeded:1,renderer:e=>(0,r.jsx)("div",{dangerouslySetInnerHTML:{__html:e}})},{name:"StringWithIcon",fieldsNeeded:2,renderer:(e,t)=>(0,r.jsx)(p,{icon:t,name:e})},{name:"NumberWithDelta",fieldsNeeded:2,renderer:(e,t)=>(0,r.jsx)(u,{number:e,delta:t})}],h=((0,d.FB)(),(0,d.FB)()),g=e=>{const t=[];e.data.length>0&&void 0!==e.data[0].__index__&&t.push(h.accessor((e=>e),{id:"__index__",header:()=>"#",cell:e=>(0,r.jsx)("span",{children:e.getValue().__index__}),size:30})),t.push(...e.options.map(((e,t)=>{const{name:a,width:n,type:s,fields:r}=e;return h.accessor((e=>e),{id:`${t}-${a}`,header:()=>a,cell:e=>{const t=m.find((e=>e.name===s)),a=r.map((t=>e.getValue()[t]));return t.renderer(...a)},size:n})})));const a=(0,l.N4)({columns:t,data:e.data,getCoreRowModel:(0,d.HT)()});return(0,r.jsx)(i,{title:e.title,children:(0,r.jsx)(o,{table:a})})}},4086:(e,t,a)=>{a.r(t),a.d(t,{default:()=>L});var n=a(85373),s=a(96540),r=a(94335),i=a(19746),l=a(21312),o=a(71380);const d="graphContainer_WFZs",c="bannerBox_OXKo",u="bannerTitle_Bnj1",p="bannerContent_tqTZ",m="leftBox_qnKg",h="rightBox_tLfp";var g=a(74848);const b=e=>{let{graph:t,month:a}=e;const[n,r]=(0,s.useState)([]);return(0,s.useEffect)((()=>{if(t){if(!Object.keys(t.data).includes(a))return;const e=t.data[a].nodes.map((e=>({id:t.meta.nodes[e[0]][0],login:t.meta.nodes[e[0]][1],value:e[2]}))).filter((e=>"u"===e.id[0])).sort(((e,t)=>t.value-e.value));r(e)}}),[t,a]),(0,g.jsx)("div",{className:m,children:(0,g.jsx)(o.A,{title:(0,l.T)({id:"communityLeaderboard.leaderboard.title"}),data:n,options:[{name:(0,l.T)({id:"communityLeaderboard.leaderboard.login"}),type:"String",fields:["login"],width:200},{name:"OpenRank",type:"String",fields:["value"],width:100}]})})},f=e=>{let{graph:t,id:a,month:n,typeMap:r,platform:i}=e;const[d,c]=(0,s.useState)([]);return(0,s.useEffect)((()=>{if(t&&a){if(!Object.keys(t.data).includes(n))return;if(-1===a)return void c([]);const e=t.data[n],s=e.nodes.find((e=>t.meta.nodes[e[0]][0]===a)),l=[];if(s){l.push(["Self",t.meta.retentionFactor,s[1],(t.meta.retentionFactor*s[1]).toFixed(3)]);const n=e.links.filter((e=>t.meta.nodes[e[1]][0]===a)).map((a=>{const n=a[0],s=t.meta.nodes[n],l=e.nodes.find((e=>e[0]===n)),o=r.get(s[0][0]);let d=s[1];return"pull"===o?d="#"+s[0].slice(1)+" "+s[1]:"issue"===o&&(d="#"+("gitee"===i?parseInt(s[0].slice(1)).toString(36).toUpperCase():s[0].slice(1))+" "+s[1]),[d.substring(0,20),parseFloat(((1-t.meta.retentionFactor)*a[2]).toFixed(3)),l[2],parseFloat(((1-t.meta.retentionFactor)*a[2]*l[2]).toFixed(3))]})).sort(((e,t)=>t[3]-e[3])),o=e.nodes.find((e=>0===e[0]));n.push([t.meta.repoName,parseFloat((1/(e.nodes.length-1)).toFixed(3)),o[2],parseFloat((1/(e.nodes.length-1)*o[2]).toFixed(3))]),c([...l,...n])}}}),[t,a,n,r,i]),(0,g.jsx)("div",{className:h,children:(0,g.jsx)(o.A,{title:(0,l.T)({id:"communityLeaderboard.details.title"}),data:d,options:[{name:(0,l.T)({id:"communityLeaderboard.details.from"}),type:"String",fields:[0],width:120},{name:(0,l.T)({id:"communityLeaderboard.details.ratio"}),type:"String",fields:[1],width:60},{name:(0,l.T)({id:"communityLeaderboard.details.value"}),type:"String",fields:[2],width:60},{name:"OpenRank",type:"String",fields:[3],width:80}]})})};var x=a(9393);const _=e=>{let{graph:t,month:a,platform:n,typeMap:r,onNodeDblClick:l}=e;return(0,s.useEffect)((()=>{if(t){const s=document.getElementById("graph"),o=x.init(s);try{if(!Object.keys(t.data).includes(a))return;const e=t.data[a].nodes.map((e=>{const a=t.meta.nodes[e[0]][0],s=r.get(a[0]);let i=t.meta.nodes[e[0]][1];return"pull"===s?i="#"+a.slice(1):"issue"===s&&(i="#"+("gitee"===n?parseInt(a.slice(1)).toString(36).toUpperCase():a.slice(1))),{id:a,initialValue:e[1],value:e[2],name:i,symbolSize:10*Math.log(e[2]+1),category:s}})).sort(((e,t)=>t.value-e.value)).slice(0,300),s=new Set(e.map((e=>e.id))),i=t.data[a].links.filter((e=>s.has(t.meta.nodes[e[0]][0])&&s.has(t.meta.nodes[e[1]][0]))).map((e=>({source:t.meta.nodes[e[0]][0],target:t.meta.nodes[e[1]][0],value:e[2]})));e.forEach((e=>{"issue"!==e.category&&"pull"!==e.category||i.push({source:t.meta.nodes[0][0],target:e.id,value:.05})}));const d=Array.from(r.values()),c={legend:{data:d,top:"90%",left:"50px"},tooltip:{trigger:"item"},series:[{name:"Collaborative graph",type:"graph",layout:"force",nodes:e,links:i,categories:d.map((e=>({name:e}))),roam:!0,label:{position:"right",show:!0},force:{layoutAnimation:!1,repulsion:300},progressive:400,progressiveThreshold:2e3}]};o.setOption(c),o.on("dblclick",(e=>l(e.data.id)))}catch(e){i.Ay.error("\u56fe\u8868\u52a0\u8f7d\u5931\u8d25")}return()=>{o.dispose()}}}),[t,a,n]),(0,g.jsx)(g.Fragment,{children:(0,g.jsx)("div",{id:"graph",className:d})})};var v=a(91865),y=a(3743),j=a(26279),C=a(44586);const S=e=>({container:t=>({...t,display:"inline-block",height:"50px",margin:"0px 10px 0px 0px",width:e}),control:e=>({...e,height:"100%"}),option:(e,t)=>({...e,backgroundColor:t.isSelected?"#3366FF":t.isFocused?"#f0f0f0":null,color:t.isSelected?"white":"black"}),singleValue:e=>({...e,color:"#000"})}),w={padding:"0px 15px 0px 15px",borderRadius:"5px",background:"#3366FF",color:"white",border:"none",height:"50px"},k=["GitHub","Gitee"],T=["Repo","User"],N=new Map([["OpenRank","openrank"],["Activity","activity"],["Stars","stars"],["Forks","technical_fork"],["Attention","attention"],["Bus Factor","bus_factor"],["Contributors","new_contributors"],["Issues",["issues_new","issues_closed","issue_comments"]],["Issue Response Time","issue_response_time"],["Issue Resolution Duration","issue_resolution_duration"],["Change Requests",["change_requests","change_requests_accepted","change_requests_reviews"]],["Change Request Response Time","change_request_response_time"],["Change Request Resolution Duration","change_request_resolution_duration"],["Code Change Lines",["code_change_lines_add","code_change_lines_remove"]]]),A=new Map([["OpenRank","openrank"],["Activity","activity"]]),F=e=>{let{platform:t,type:a,metric:n,onSubmit:i}=e;const[o,d]=(0,s.useState)([]),[c,u]=(0,s.useState)([]),[p,m]=(0,s.useState)([]),[h,b]=(0,s.useState)(""),[f,x]=(0,s.useState)(null),[_,v]=(0,s.useState)(null),[y,F]=(0,s.useState)(null),[I,R]=(0,s.useState)([]),[L,D]=(0,s.useState)(null),{siteConfig:$}=(0,C.A)(),{customFields:E}=$;return(0,s.useEffect)((()=>{let e=a;a?T.includes(a)||(e=T[0],!0!==a&&alert(`Invalid type: ${a}`)):e=T[0],F({value:e,label:e}),t?k.includes(t)?v({value:t,label:t}):(v({value:k[0],label:k[0]}),!0!==t&&alert(`Invalid platform: ${t}`)):v({value:k[0],label:k[0]});(async()=>{try{const e=await r.A.get(`${E.ossBaseUrl}repo_list.csv`),t=e.data.split("\n").slice(1).map((e=>e.trim().split(","))).filter((e=>3===e.length&&""!=e[1]&&""!=e[2])).map((e=>({platform:e[1],name:e[2]})));d(t)}catch(e){console.error("Error fetching repo list:",e)}})(),(async()=>{try{const e=await r.A.get(`${E.ossBaseUrl}user_list.csv`),t=e.data.split("\n").slice(1).map((e=>e.trim().split(","))).filter((e=>3===e.length&&""!=e[1]&&""!=e[2])).map((e=>({platform:e[1],name:e[2]})));u(t)}catch(e){console.error("Error fetching user list:",e)}})()}),[]),(0,s.useEffect)((()=>{if(!_||!y)return;const e=[],t="Repo"===y.value?o:c;for(const a of t)if(a.platform===_.value.toLowerCase()&&(h?a.name.toLowerCase().includes(h.toLowerCase())&&e.push({value:a.name,label:a.name}):e.push({value:a.name,label:a.name})),e.length>=20)break;m(e)}),[_,y,o,c,h]),(0,s.useEffect)((()=>{if(!y)return;const e=[...("Repo"===y.value?N:A).entries()].map((e=>({value:e[1],label:e[0]})));R(e),D({value:"openrank",label:"OpenRank"})}),[y]),(0,g.jsxs)("div",{children:[!(t&&k.includes(t)||!0===t)&&(0,g.jsx)(j.Ay,{options:k.map((e=>({value:e,label:e}))),value:_,onChange:e=>{v(e),x(null)},isSearchable:!1,isClearable:!1,styles:S("120px")}),!(a&&T.includes(a)||!0===a)&&(0,g.jsx)(j.Ay,{options:T.map((e=>({value:e,label:e}))),value:y,onChange:e=>{F(e),x(null)},isSearchable:!1,isClearable:!1,styles:S("100px")}),(0,g.jsx)(j.Ay,{options:p,value:f,inputValue:h,onInputChange:b,onChange:e=>{x(e),b("")},placeholder:(0,l.T)({id:"searchInput.placeholder"}),isClearable:!0,styles:S("300px")}),!n&&(0,g.jsx)(j.Ay,{options:I,value:L,onChange:e=>{D(e)},isSearchable:!1,isClearable:!1,styles:S("200px")}),(0,g.jsx)("button",{style:w,onClick:()=>{i&&i({platform:_?.value,type:y?.value,name:f?.value,metric:L?.value,metricDisplayName:L?.label})},children:(0,l.T)({id:"searchInput.submit"})})]})},I=e=>{let{onSubmit:t,setDate:a,datePlaceholder:n,disabledDate:s}=e;return(0,g.jsxs)("div",{className:c,children:[(0,g.jsx)("div",{className:u,children:(0,l.T)({id:"communityLeaderboard.banner.title"})}),(0,g.jsxs)("div",{className:p,children:[(0,g.jsx)(F,{type:!0,metric:"OpenRank",onSubmit:t}),(0,g.jsx)(v.Ay,{theme:{components:{DatePicker:{cellHeight:52,cellWidth:23}}},children:(0,g.jsx)(y.A,{onChange:(e,t)=>{const n=t.replace(/-/g,"");a(n),console.log(e,n)},picker:"month",placeholder:n,disabledDate:s})})]})]})},R=()=>{const[e,t]=(0,s.useState)(null),[a,n]=(0,s.useState)(null),[o,d]=(0,s.useState)(""),[c,u]=(0,s.useState)(""),[p,m]=(0,s.useState)([]),[h,x]=(0,s.useState)(""),v=new Map([["r","repo"],["i","issue"],["p","pull"],["u","user"]]),y=async(e,a)=>{const n=i.Ay.loading((0,l.T)({id:"communityLeaderboard.fetchingData"}),0);try{const n=(await r.A.get(`https://oss.open-digger.cn/${e}/${a}/community_openrank.json`)).data;if(!n||0===Object.keys(n).length)throw"No valid data found";const s=Object.keys(n.data),i=s[s.length-1],l=`${i.slice(0,4)}-${i.slice(4)}`;t(n),u(i),x(l),m(s),d(e)}catch(s){i.Ay.error((0,l.T)({id:"communityLeaderboard.fetchDataError"})),console.error(s)}finally{n()}};(0,s.useEffect)((()=>{if(e){if(!Object.keys(e.data).includes(c))return void i.Ay.error((0,l.T)({id:"communityLeaderboard.noDataForMonth"}));n(-1)}}),[c]);return(0,s.useEffect)((()=>{y("github","ant-design/ant-design")}),[]),(0,g.jsxs)(g.Fragment,{children:[(0,g.jsx)(I,{onSubmit:e=>{y(e.platform.toLowerCase(),e.name)},setDate:u,datePlaceholder:h,disabledDate:e=>{const t=e.format("YYYYMM");return!p.includes(t)}}),(0,g.jsx)(_,{graph:e,month:c,platform:o,typeMap:v,onNodeDblClick:e=>{n(e)}}),(0,g.jsx)(b,{graph:e,month:c}),(0,g.jsx)(f,{graph:e,id:a,month:c,typeMap:v,platform:o})]})},L=()=>(0,g.jsx)("div",{className:"no-footer",children:(0,g.jsx)(n.A,{children:(0,g.jsx)(R,{})})})},87543:(e,t,a)=>{a.d(t,{A:()=>r});var n=a(44809),s=a.n(n);const r=async function(e){const{url:t,type:a}=e;try{const e=await fetch(t);if(!e.ok)throw new Error(`HTTP error! status: ${e.status}`);if("json"===a)return await e.json();if("csv"===a){const t=await e.text();return s().parse(t,{header:!0}).data}}catch(n){throw console.error("Fetch error:",n),n}}},1710:(e,t,a)=>{a.d(t,{Ay:()=>o,YW:()=>i,T_:()=>l});var n=a(57417);const s="/open-source-insight";var r=a(87543);const i=e=>`${s}/data/${e}`,l=e=>`${s}/img/${e}`,o=e=>{let{url:t,type:a="json"}=e;const{data:s,loading:i}=(0,n.A)((()=>(0,r.A)({url:t,type:a})),{cacheKey:t,cacheTime:864e5});return{data:s,loading:i}}}}]);